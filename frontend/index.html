<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid Editor - Diagram Creator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">Mermaid Editor</div>
            <div class="toolbar">
                <button class="btn primary" onclick="generateDiagram()">
                    <span>üîÑ</span> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°
                </button>
                <div class="examples-dropdown">
                    <button class="btn" onclick="toggleExamples()">
                        <span>üìã</span> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                    </button>
                    <div class="examples-content" id="examplesContent">
                        <div class="example-item" onclick="loadExample('sequence')">
                            <div class="example-title">Sequence Diagram</div>
                            <div class="example-desc">‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
                        </div>
                        <div class="example-item" onclick="loadExample('class')">
                            <div class="example-title">Class Diagram</div>
                            <div class="example-desc">‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏•‡∏≤‡∏™</div>
                        </div>
                        <div class="example-item" onclick="loadExample('flowchart')">
                            <div class="example-title">Flowchart</div>
                            <div class="example-desc">‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡πÇ‡∏ü‡∏•‡∏ß‡πå</div>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="clearEditor()">
                    <span>üóëÔ∏è</span> ‡∏•‡πâ‡∏≤‡∏á
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="editor-panel">
                <div class="panel-header">
                    <span>üìù Mermaid Code</span>
                    <span id="lineCount">1 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</span>
                </div>
                <textarea 
                    class="editor" 
                    id="umlEditor"
                    placeholder="graph TD
A[Start] --> B{Decision}
B -- Yes --> C[Do something]
B -- No --> D[Do something else]
C --> E[End]
D --> E"
                    spellcheck="false"
                    oninput="updateLineCount()"
                >sequenceDiagram
    participant Alice
    participant Bob
    Alice->>Bob: ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ Bob!
    Bob-->>Alice: ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ Alice!</textarea>
            </div>

            <div class="preview-panel">
                <div class="panel-header">
                    <span>üëÅÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°</span>
                    <button class="btn" onclick="generateDiagram()" style="padding: 4px 8px; font-size: 12px;">
                        ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä
                    </button>
                </div>
                <div class="preview-content" id="previewContent">
                    <div class="help-text">
                        <h3>üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ Mermaid Editor</h3>
                        <p>1. ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î Mermaid ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</p>
                        <p>2. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</p>
                        <p>3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                        <br>
                        <p><strong>‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö:</strong> ‡∏Å‡∏î Ctrl+Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-bar">
            <div>Mermaid Editor - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</div>
            <div id="statusText">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
        </div>
    </div>

    <script>
        // Mermaid examples
        const examples = {
            sequence: `sequenceDiagram
    participant Alice
    participant Bob
    Alice->>Bob: ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ Bob!
    Bob-->>Alice: ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ Alice!`,

            class: `classDiagram
    Animal <|-- Duck
    Animal <|-- Fish
    Animal <|-- Zebra
    Animal : +int age
    Animal : +String gender
    Animal: +isMammal()
    Animal: +mate()
    class Duck{
      +String beakColor
      +swim()
      +quack()
    }`,

            flowchart: `graph TD
    A[Start] --> B{Decision}
    B -- Yes --> C[Do something]
    B -- No --> D[Do something else]
    C --> E[End]
    D --> E`
        };

        // Initialize
        updateLineCount();

        // Auto-generate diagram on load
        setTimeout(() => {
            generateDiagram();
        }, 1000);

        function updateLineCount() {
            const editor = document.getElementById('umlEditor');
            const lines = editor.value.split('\n').length;
            document.getElementById('lineCount').textContent = `${lines} ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î`;
        }

        function updateStatus(message) {
            document.getElementById('statusText').textContent = message;
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á list ‡πÄ‡∏õ‡πá‡∏ô Mermaid flowchart
        function listToMermaidFlowchart(text) {
            const lines = text.split('\n').map(line => line.trim()).filter(line => line);
            let mermaid = 'graph TD\n';
            for (let i = 0; i < lines.length; i++) {
                const label = lines[i].replace(/^\d+\.\s*/, '');
                mermaid += `    step${i + 1}["${label}"]\n`;
                if (i > 0) {
                    mermaid += `    step${i} --> step${i + 1}\n`;
                }
            }
            return mermaid;
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç generateDiagram ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö list
        function generateDiagram() {
            let code = document.getElementById('umlEditor').value.trim();
            if (!code) {
                showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î Mermaid ‡∏´‡∏£‡∏∑‡∏≠ list');
                return;
            }

            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô list 1. ... 2. ... ‡πÉ‡∏´‡πâ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Mermaid
            if (/^\d+\.\s+/.test(code)) {
                code = listToMermaidFlowchart(code);
            }

            showLoading();
            updateStatus('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°...');

            setTimeout(() => {
                const preview = document.getElementById('previewContent');
                preview.innerHTML = `<pre class="mermaid">${code}</pre>`;
                if (window.mermaid) {
                    mermaid.init(undefined, preview);
                }
                updateStatus('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }, 300);
        }

        function showLoading() {
            const preview = document.getElementById('previewContent');
            preview.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏°...</div>
                </div>
            `;
        }

        function showError(message) {
            const preview = document.getElementById('previewContent');
            preview.innerHTML = `
                <div class="error">
                    <h3>‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                    <p>${message}</p>
                    <br>
                    <p><strong>‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö:</strong></p>
                    <p>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö syntax ‡∏Ç‡∏≠‡∏á Mermaid</p>
                    <p>‚Ä¢ ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á"</p>
                </div>
            `;
        }

        function toggleExamples() {
            const content = document.getElementById('examplesContent');
            content.classList.toggle('show');
        }

        function loadExample(type) {
            if (examples[type]) {
                document.getElementById('umlEditor').value = examples[type];
                updateLineCount();
                toggleExamples();
                generateDiagram();
            }
        }

        function clearEditor() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                document.getElementById('umlEditor').value = '';
                document.getElementById('previewContent').innerHTML = `
                    <div class="help-text">
                        <h3>üìù ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
                        <p>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î Mermaid ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á"</p>
                    </div>
                `;
                updateLineCount();
                updateStatus('‡∏•‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                generateDiagram();
            }
        });

        // Close examples dropdown when clicking outside
        document.addEventListener('click', function(e) {
            const dropdown = document.querySelector('.examples-dropdown');
            if (!dropdown.contains(e.target)) {
                document.getElementById('examplesContent').classList.remove('show');
            }
        });

        // Auto-resize editor
        function autoResize() {
            const editor = document.getElementById('umlEditor');
            editor.style.height = 'auto';
            editor.style.height = editor.scrollHeight + 'px';
        }
    </script>
</body>
</html>